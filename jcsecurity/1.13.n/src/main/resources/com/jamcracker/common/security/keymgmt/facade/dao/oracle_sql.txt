GET_MISSING_KEY_ACTORS = (SELECT ORGANIZATION_ID FROM JCP_DSTORE DS) MINUS (select DISTINCT ACTOR_ID as ORGANIZATION_ID FROM JCP_CRYPTO_KEYS)
GET_CHILD_ACTORS_WITH_PARENT = select org.actor_id, org.parent_syndicator_id from  jcp_organization org where actor_id != 1000 and parent_syndicator_id != 1000 and parent_syndicator_id not in (select o2.actor_id from  jcp_organization o2 where o2.parent_syndicator_id = 1000)
GET_PARENT_FOR_CHILD = select org.parent_syndicator_id from  jcp_organization org where actor_id != 1000 and parent_syndicator_id != 1000 and parent_syndicator_id not in (select o2.actor_id from  jcp_organization o2 where o2.parent_syndicator_id = 1000) and actor_id=?
GET_ALL_KEYS = SELECT MGMN.CRYPTO_TYPE,MGMN.KEY_VERSION,MGMN.KEY_VALUE,MGMN.ACTOR_ID,MGMN.STATUS,MGMN.CRYPTO_ID,(CASE WHEN MGMN.CRYPTO_TYPE = 1 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="PII"]/algorithm') WHEN MGMN.CRYPTO_TYPE = 2 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="FII"]/algorithm') WHEN MGMN.CRYPTO_TYPE = 3 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="NORMAL"]/algorithm') WHEN MGMN.CRYPTO_TYPE = 4 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="HPROTECTOR"]/algorithm') END) AS ALGORITHM,(CASE WHEN MGMN.CRYPTO_TYPE = 1 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="PII"]/providerName') WHEN MGMN.CRYPTO_TYPE = 2 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="FII"]/providerName') WHEN MGMN.CRYPTO_TYPE = 3 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="NORMAL"]/providerName') WHEN MGMN.CRYPTO_TYPE = 4 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="HPROTECTOR"]/providerName') END) AS PROVIDER,(CASE WHEN MGMN.CRYPTO_TYPE = 1 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="PII"]/keyType')WHEN MGMN.CRYPTO_TYPE = 2 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="FII"]/keyType') WHEN MGMN.CRYPTO_TYPE = 3 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="NORMAL"]/keyType')WHEN MGMN.CRYPTO_TYPE = 4 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="HPROTECTOR"]/keyType') END) AS keyType,(CASE WHEN MGMN.CRYPTO_TYPE = 1 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="PII"]/keyLength') WHEN MGMN.CRYPTO_TYPE = 2 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="FII"]/keyLength') WHEN MGMN.CRYPTO_TYPE = 3 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="NORMAL"]/keyLength') WHEN MGMN.CRYPTO_TYPE = 4 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="HPROTECTOR"]/keyLength') END) AS keyLength,(CASE WHEN MGMN.CRYPTO_TYPE = 1 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="PII"]/keyId') WHEN MGMN.CRYPTO_TYPE = 2 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="FII"]/keyId') WHEN MGMN.CRYPTO_TYPE = 3 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="NORMAL"]/keyId') WHEN MGMN.CRYPTO_TYPE = 4 THEN EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="HPROTECTOR"]/keyId') END) AS keyId FROM JCP_KEY_CYCLE CYC,(SELECT MGMT.CRYPTO_ID,MGMT.KEY_ID,MGMT.CRYPTO_TYPE,MGMT.KEY_VERSION,MGMT.KEY_VALUE,MGMT.ACTOR_ID,MGMT.STATUS FROM JCP_CRYPTO_KEY_MGMT MGMT WHERE MGMT.STATUS NOT IN('C','DC') ORDER BY MGMT.KEY_ID)MGMN WHERE CYC.KEY_ID=MGMN.KEY_ID
GET_PROTECTOR_KEY = SELECT MGMT.KEY_VERSION, MGMT.KEY_VALUE,DECODE(MGMT.CRYPTO_TYPE,4,TO_CHAR(EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="HPROTECTOR"]/algorithm')))AS ALGORITHM,DECODE(MGMT.CRYPTO_TYPE,4,TO_CHAR(EXTRACTVALUE(XMLTYPE(CMX),'//labels[@id="HPROTECTOR"]/providerName')))AS PROVIDER FROM JCP_KEY_CYCLE CYC,JCP_CRYPTO_KEY_MGMT MGMT WHERE CYC.KEY_ID = MGMT.KEY_ID AND MGMT.CRYPTO_TYPE=4 AND MGMT.ACTOR_ID =1000 AND MGMT.STATUS NOT IN('C','DC')